def transform_to_flat(accommodation: Accommodation, platform: str, scraped_at: str) -> CozyCozyFlatData:
    return CozyCozyFlatData(
        _id=accommodation._id,
        type=accommodation.type,
        accommodationId=accommodation.accommodationId,
        uid=accommodation.uid,
        title=accommodation.title,
        subTitle=accommodation.subTitle,
        subTitleDetails=accommodation.subTitleDetails,
        surfaceText=accommodation.surfaceText,
        locationWarning=accommodation.locationWarning,
        locationText=accommodation.locationText,
        price_value=accommodation.highlightedResults[0].totalPrice.value if accommodation.highlightedResults else None,
        price_currencyCode=accommodation.highlightedResults[0].totalPrice.currencyCode if accommodation.highlightedResults else None,
        price_min=accommodation.highlightedResults[0].totalPrice.min if accommodation.highlightedResults else None,
        price_max=accommodation.highlightedResults[0].totalPrice.max if accommodation.highlightedResults else None,
        price_indicative=accommodation.highlightedResults[0].totalPrice.indicative if accommodation.highlightedResults else None,
        price_instantBooking=accommodation.highlightedResults[0].totalPrice.instantBooking if accommodation.highlightedResults else None,
        price_text=accommodation.highlightedResults[0].totalPrice.text if accommodation.highlightedResults else None,
        price_shortText=accommodation.highlightedResults[0].totalPrice.shortText if accommodation.highlightedResults else None,
        price_deeplinkUrl=accommodation.highlightedResults[0].totalPrice.deeplinkUrl if accommodation.highlightedResults else None,
        price_mapSearchId=accommodation.highlightedResults[0].totalPrice.mapSearchId if accommodation.highlightedResults else None,
        price_requiresLogin=accommodation.highlightedResults[0].totalPrice.requiresLogin if accommodation.highlightedResults else None,
        providerName=accommodation.highlightedResults[0].providerName if accommodation.highlightedResults else None,
        providerCode=accommodation.highlightedResults[0].providerCode if accommodation.highlightedResults else None,
        providerLogoCode=accommodation.highlightedResults[0].providerLogoCode if accommodation.highlightedResults else None,
        providerText=accommodation.highlightedResults[0].providerText if accommodation.highlightedResults else None,
        bedRoomCount=accommodation.highlightedResults[0].bedRoomCount if accommodation.highlightedResults else None,
        resultCount=accommodation.highlightedResults[0].resultCount if accommodation.highlightedResults else None,
        cityName=accommodation.highlightedResults[0].cityName if accommodation.highlightedResults else None,
        firstUrls=accommodation.lightThumbnails.firstUrls,
        lastUrl=accommodation.lightThumbnails.lastUrl,
        thumbnails_count=accommodation.lightThumbnails.count,
        thumbnails_instantBooking=accommodation.lightThumbnails.instantBooking,
        ratingCount=accommodation.lightThumbnails.ratingCount,
        ratingScore=accommodation.lightThumbnails.ratingScore,
        coordinates_latitude=accommodation.coordinates.latitude,
        coordinates_longitude=accommodation.coordinates.longitude,
        cancellationCategory=accommodation.cancellationCategory,
        cancellationPolicy=accommodation.cancellationPolicy,
        prioritizedAccommodation=accommodation.prioritizedAccommodation,
        platform=platform,
        scraped_at=scraped_at
    )
